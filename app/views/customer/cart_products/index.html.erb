<div class="container">
  <div class="row justify-content-end">
    <h2 class="bg-light">ショッピングカート</h2>
    <div class="col-lg-8 text-right">
      <%= link_to "カートを空にする", cart_products_destroy_all_cart_products_path, method: :delete, class:"btn btn-sm btn-danger" %>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <table class="table table-bordered">
        <tr>
          <td class="col-3 bg-light">商品名</td>
          <td class="col-1 bg-light">単価（税込）</td>
          <td class="col-1 bg-light">数量</td>
          <td class="col-1 bg-light">小計</td>
          <td class="col-1 bg-light"></td>
        </tr>
        <% @cart_products.each do |product| %>
        <tr>
          <td><%= attachment_image_tag(product.product, :image, :fill, 50, 50 , size: "60x45") %>
              <%= product.product.name %></td>
          <td><%= (product.product.price*1.1).floor %></td>
          <td><%= form_with model: product, local:true do |f| %>
              <%= f.select :quantity, [*(1..20)] %>
              <%= f.submit "変更", class: "btn btn-success  btn-sm" %>
              <% end %>
          </td>
          <td><%= (product.quantity * (product.product.price*1.1).floor).to_s(:delimited) %></td>
          <td><%= link_to "削除する", cart_product_path(product), method: :delete, class:"btn btn-sm btn-danger" %></td>
        </tr>
        <% end %>
      </table>
    </div>
  </div>
  <div class="row justify-content-end">
    <div class="col-lg-3">
      <%= link_to "買い物を続ける", products_path, class:"btn btn-sm btn-primary" %>
    </div>
    <div class="col-lg-8">
      <table class="table-bordered offset-7">
        <td class="col-2 bg-light">合計金額</td>
        <td class="col-2"><%= @total.round.to_s(:delimited)%></td>
      </table>
    </div>
  </div>
  <div class="row justify-content-center">
    <% if @cart_products.present? %>
      <%= link_to "情報入力に進む", new_order_path,  class:"btn btn-sm btn-success" %>
    <% end %>
  </div>
</div>
